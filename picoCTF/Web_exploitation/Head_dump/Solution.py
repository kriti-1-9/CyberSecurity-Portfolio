import subprocess
import sys
import re

if len(sys.argv) != 2:
    print("Usage: python3 solution.py <heap_snapshot_file>")
    sys.exit(1)

filename = sys.argv[1]

# Extract strings
result = subprocess.run(["strings", filename], capture_output=True, text=True)

# Search for picoCTF flag pattern
matches = re.findall(r"picoCTF\{.*?\}", result.stdout)

if matches:
    print("[+] Flag found:")
    for match in matches:
        print(match)
else:
    print("[-] No flag found.")